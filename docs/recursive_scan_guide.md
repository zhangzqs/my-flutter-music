# WebDAV 递归扫描功能说明

## 🎯 功能概述

WebDAV音乐播放器现在支持自动递归扫描功能，连接WebDAV服务器后会自动搜索所有层级文件夹中的音乐文件。

## ✨ 主要特性

### 🔄 自动递归扫描
- **默认行为**: 连接WebDAV服务器后自动开始递归扫描
- **深度控制**: 用户可以在连接时指定最大扫描深度
- **智能过滤**: 自动跳过系统文件夹（.开头、Trash、@eaDir等）

### 📊 扫描深度设置
- **-1**: 无限制递归扫描（默认）
- **0**: 仅扫描根目录
- **1**: 扫描根目录及其直接子文件夹
- **N**: 扫描N层深度的文件夹

### 🎵 文件组织
- **按文件夹分组**: 自动按文件夹路径分组显示音乐文件
- **路径显示**: 显示每个文件的相对路径信息
- **统计信息**: 显示每个文件夹的音乐文件数量

## 🔧 使用方法

### 连接设置
1. 点击"WebDAV连接设置"
2. 填写服务器信息（地址、端口、用户名、密码等）
3. 设置基础路径（音乐文件的根目录）
4. **设置最大扫描深度**：
   - `-1`：无限制（推荐，会扫描所有子文件夹）
   - `3`：扫描3层深度（适合大型音乐库）
   - `1`：仅扫描一层（适合结构简单的音乐库）
5. 点击"连接"

### 扫描过程
- 连接成功后自动开始递归扫描
- 实时显示扫描进度：
  - 当前扫描的文件夹路径
  - 已扫描的文件夹数量
  - 找到的音乐文件数量
- 扫描完成后按文件夹分组显示结果

### 重新扫描
- 点击"重新扫描"按钮可以重新扫描所有文件夹
- 保持原有的深度设置

## 📁 支持的文件格式

- **MP3** (.mp3)
- **M4A** (.m4a)
- **AAC** (.aac)
- **FLAC** (.flac)
- **WAV** (.wav)
- **OGG** (.ogg)

## 🎨 界面优化

### 文件夹视图
- 文件夹标题以特殊样式显示
- 显示文件夹图标和音乐文件数量
- 每个文件显示相对路径信息

### 扫描状态
- 实时显示扫描进度
- 完成后显示总文件数和扫描深度
- 扫描过程中可以查看已找到的文件

## ⚡ 性能优化

### 智能扫描
- 跳过隐藏文件夹和系统目录
- 深度限制避免过度扫描
- 异步扫描不阻塞UI

### 内存管理
- 实时更新扫描进度
- 合理的文件对象创建
- 错误处理确保稳定性

## 📝 配置示例

### 个人音乐库（推荐）
```
最大扫描深度: -1 (无限制)
基础路径: /music
```

### 大型音乐服务器
```
最大扫描深度: 5
基础路径: /media/music
```

### 简单文件夹结构
```
最大扫描深度: 2
基础路径: /songs
```

## 🔍 故障排除

### 扫描过慢
- 减少最大扫描深度
- 检查网络连接速度
- 确认WebDAV服务器性能

### 找不到文件
- 检查基础路径设置
- 确认文件格式是否支持
- 增加最大扫描深度

### 连接问题
- 验证服务器地址和端口
- 检查用户名密码
- 确认网络连接

## 🎯 使用建议

1. **首次使用**: 建议设置为无限制扫描（-1）
2. **大型音乐库**: 可以设置适当的深度限制（如3-5层）
3. **网络较慢**: 设置较小的深度避免长时间等待
4. **定期重扫**: 添加新音乐后点击"重新扫描"更新列表

这个功能大大简化了音乐文件的管理，让你可以轻松访问WebDAV服务器上任意深度的音乐文件！
